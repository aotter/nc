var ke=Object.defineProperty,xe=(a,e,i)=>e in a?ke(a,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[e]=i,n=(a,e,i)=>(xe(a,typeof e!="symbol"?e+"":e,i),i);import{b as R,c as k,f as h,a as Ce,d as De,r as x,o as qe,n as E,u as t,t as Te,j as Pe,k as je,l as He}from"./20e3268f.js";import{a as Oe}from"./1236a3b0.js";import{u as Se}from"./11070180.js";import{a as Ve}from"./bd02d60c.js";import{u as Ie,a as We}from"./37a621d8.js";import{u as Fe}from"./7a3a1d9a.js";import{_ as ze}from"./66dda505.js";const Be={xmlns:"http://www.w3.org/2000/svg",fill:"none","stroke-width":"1.5",viewBox:"0 0 24 24"},Ne=h("path",{stroke:"currentColor",d:"M2 14v-4a1 1 0 0 1 1-1h2.697a1 1 0 0 0 .555-.168l4.193-2.796A1 1 0 0 1 12 6.87V17.13a1 1 0 0 1-1.555.832l-4.193-2.795A1 1 0 0 0 5.697 15H3a1 1 0 0 1-1-1Z"},null,-1),Ze=h("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round",d:"M16.5 7.5S18 9 18 11.5s-1.5 4-1.5 4M19.5 4.5S22 7 22 11.5s-2.5 7-2.5 7"},null,-1),Ge=[Ne,Ze];function Ue(a,e){return R(),k("svg",Be,Ge)}const $e={render:Ue},Je={xmlns:"http://www.w3.org/2000/svg",fill:"none","stroke-width":"1.5",viewBox:"0 0 24 24"},Ke=h("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round",d:"m17 14 2-2m2-2-2 2m0 0-2-2m2 2 2 2"},null,-1),Qe=h("path",{stroke:"currentColor",d:"M3 14v-4a1 1 0 0 1 1-1h2.697a1 1 0 0 0 .555-.168l4.193-2.796A1 1 0 0 1 13 6.87V17.13a1 1 0 0 1-1.555.832l-4.193-2.795A1 1 0 0 0 6.697 15H4a1 1 0 0 1-1-1Z"},null,-1),Xe=[Ke,Qe];function Ye(a,e){return R(),k("svg",Je,Xe)}const et={render:Ye};var tt=function(a){return new Promise(function(e,i){var o=document.createElement("script");o.async=!0,o.src=a,o.onload=e,o.onerror=i,document.body.appendChild(o)})},it="https://imasdk.googleapis.com/js/sdkloader/ima3.js",L=null,Ee=function(){L=null},at=function(){var a=window;return a.google&&a.google.ima?Promise.resolve(a.google.ima):L||(L=tt(it).then(function(){return a.google.ima}),L.then(Ee).catch(Ee),L)};class ot{constructor(){n(this,"_playing",!1),n(this,"_started",!1),n(this,"_muted",!0),n(this,"_config",{}),n(this,"ima"),n(this,"adDisplayContainer"),n(this,"adsLoader"),n(this,"adsRequest"),n(this,"adsManager"),n(this,"currentAd",null),n(this,"playHeadAnimationRequestId",null)}get playing(){return this._playing}set playing(e){this._playing=e}get started(){return this._started}set started(e){this._started=e}get muted(){return this._muted}set muted(e){this._muted=e}get config(){return this._config}set config(e){this._config=e}async init(e,i){const o=await at();this.ima=o,this.config=i;const s=Ce.navigator.language.replace("-","_").toLowerCase()||"en";this.ima.settings.setLocale(s),this.adDisplayContainer=new this.ima.AdDisplayContainer(e),this.adDisplayContainer.initialize(),this.adsLoader=new this.ima.AdsLoader(this.adDisplayContainer),this.adsRequest=new this.ima.AdsRequest;const{url:r,xml:l}=this.config;r&&(this.adsRequest.adTagUrl=r),l&&(this.adsRequest.adsResponse=l),this.adsLoader.requestAds(this.adsRequest),this.adsLoader.addEventListener(this.ima.AdErrorEvent.Type.AD_ERROR,this.onAdError,!1),this.adsLoader.addEventListener(this.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,this.onAdsManagerLoaded.bind(this),!1)}onAdsManagerLoaded(e){this.adsManager=e.getAdsManager({currentTime:0,duration:0},{enablePreloading:!0,uiElements:[]}),this.adsManager.addEventListener(this.ima.AdErrorEvent.Type.AD_ERROR,this.onAdError.bind(this)),this.adsManager.addEventListener(this.ima.AdEvent.Type.ALL_ADS_COMPLETED,this.onAllAdsCompleted.bind(this)),this.adsManager.addEventListener(this.ima.AdEvent.Type.LOADED,this.onLoaded.bind(this)),this.adsManager.addEventListener(this.ima.AdEvent.Type.STARTED,this.onStarted.bind(this)),this.adsManager.init(0,0,this.ima.ViewMode.NORMAL),this.adsManager.setVolume(this.muted?0:1)}onStarted(e){this.currentAd=e.getAd(),this.started=!0}onLoaded(){var e,i;this.started?this.adsManager.start():(i=(e=this.config).playbackController)==null||i.call(e)}onAllAdsCompleted(){this.adsLoader.requestAds(this.adsRequest)}onAdError(e){console.error(e.getError()),this.destroy()}play(){this.playing=!0,this.startWatchProgress(),this.started?this.adsManager.resume():this.adsManager.start()}pause(){this.playing=!1,this.stopWatchProgress(),this.adsManager.pause()}toggleMute(){return this.muted?this.unmute():this.mute(),this.muted}mute(){return this.muted=!0,this.adsManager.setVolume(0),this.muted}unmute(){return this.muted=!1,this.adsManager.setVolume(1),this.muted}startWatchProgress(){this.stopWatchProgress();const e=()=>{var i,o,s,r;const l=+this.adsManager.getRemainingTime(),v=((o=(i=this.currentAd)==null?void 0:i.getDuration)==null?void 0:o.call(i))||0;let u=v-l;u=u>0?+u:0;const c=+(u/v)||0;(r=(s=this.config).onProgress)==null||r.call(s,{currentTime:u,duration:v,progress:c,remainingTime:l}),this.playHeadAnimationRequestId=requestAnimationFrame(e)};this.playHeadAnimationRequestId=requestAnimationFrame(e)}stopWatchProgress(){this.playHeadAnimationRequestId&&cancelAnimationFrame(this.playHeadAnimationRequestId)}destroy(){var e,i,o,s,r,l;(i=(e=this.adDisplayContainer).destroy)==null||i.call(e),(s=(o=this.adsManager).destroy)==null||s.call(o),(l=(r=this.adsLoader).destroy)==null||l.call(r),this.stopWatchProgress()}}const st=De({__name:"Vast.ce",setup(a){He(_=>{var y,d,b,A,w,M,C,D,q,T,P,j,H,O,S,V,I,W,F,z,B,N,Z,G,U,$,J,K,Q,X,Y,ee,te,ie,ae,oe,se,ne,re,le,de,ue,ce,he,ve,me,pe,ge,fe,ye,be,Ae,we,Me;return{"45b79bca":t(v).dimension[0],"45b79b8c":t(v).dimension[1],"942609d2":((d=(y=t(c))==null?void 0:y.grid)==null?void 0:d.columns)||3,"8cfe600e":((A=(b=t(c))==null?void 0:b.grid)==null?void 0:A.rows)||3,"3745303b":((M=(w=t(c))==null?void 0:w.grid)==null?void 0:M.gap)||0,cbff0f9a:((q=(D=(C=t(p))==null?void 0:C.position)==null?void 0:D.coordinate)==null?void 0:q[0])||1,62329918:((j=(P=(T=t(p))==null?void 0:T.position)==null?void 0:P.coordinate)==null?void 0:j[1])||1,"29895c3d":((S=(O=(H=t(p))==null?void 0:H.position)==null?void 0:O.dimension)==null?void 0:S[0])||3,"5e6f977e":((W=(I=(V=t(p))==null?void 0:V.position)==null?void 0:I.dimension)==null?void 0:W[1])||3,"1ea4f216":((B=(z=(F=t(m))==null?void 0:F.position)==null?void 0:z.coordinate)==null?void 0:B[0])||1,"2593c238":((G=(Z=(N=t(m))==null?void 0:N.position)==null?void 0:Z.coordinate)==null?void 0:G[1])||3,"5d03258e":((J=($=(U=t(m))==null?void 0:U.position)==null?void 0:$.dimension)==null?void 0:J[0])||1,"0664a87a":((X=(Q=(K=t(m))==null?void 0:K.position)==null?void 0:Q.dimension)==null?void 0:X[1])||1,"0545a06e":((te=(ee=(Y=t(g))==null?void 0:Y.position)==null?void 0:ee.coordinate)==null?void 0:te[0])||3,"3a2bdbaf":((oe=(ae=(ie=t(g))==null?void 0:ie.position)==null?void 0:ae.coordinate)==null?void 0:oe[1])||3,"7751c8e2":((re=(ne=(se=t(g))==null?void 0:se.position)==null?void 0:ne.dimension)==null?void 0:re[0])||1,a78ff7ba:((ue=(de=(le=t(g))==null?void 0:le.position)==null?void 0:de.dimension)==null?void 0:ue[1])||1,f5cd3682:((ve=(he=(ce=t(f))==null?void 0:ce.position)==null?void 0:he.coordinate)==null?void 0:ve[0])||1,"8c00bffc":((ge=(pe=(me=t(f))==null?void 0:me.position)==null?void 0:pe.coordinate)==null?void 0:ge[1])||3,"209aae31":((be=(ye=(fe=t(f))==null?void 0:fe.position)==null?void 0:ye.dimension)==null?void 0:be[0])||3,"5580e972":((Me=(we=(Ae=t(f))==null?void 0:Ae.position)==null?void 0:we.dimension)==null?void 0:Me[1])||3,"139a8a02":o.value}});const e=x(),i=x(!0),o=x("0%"),s=new ot,{t:r}=Fe(),{bridge:l}=Ve(),{type:v,properties:u}=Ie(),{root:c,ad:m,player:p,volume:g,progress:f}=u,Le=Se(),{handleReady:Re}=We();qe(()=>{const{xml:_,url:y}=c.settings;s.init(e.value,{onProgress:d=>{o.value=`${d.progress*100}%`},playbackController:()=>{l("on",Oe,({isIntersecting:d})=>{d?s.play():s.pause()},{target:Le.value,threshold:[0]}),Re()},url:y,xml:_})});const _e=()=>{i.value=s.toggleMute()};return(_,y)=>{var d,b,A,w,M;return R(),k("div",{class:"root",style:E(t(c).style)},[h("div",{ref_key:"playerRef",ref:e,role:"link",class:"player",style:E((d=t(p))==null?void 0:d.style)},null,4),h("p",{class:"ad",style:E((b=t(m))==null?void 0:b.style)},Te(((A=t(m))==null?void 0:A.text.content)||t(r)("ad")),5),(R(),Pe(je(i.value?t(et):t($e)),{role:"button",class:"volume",style:E((w=t(g))==null?void 0:w.style),onClick:_e},null,8,["style"])),h("div",{class:"progress",style:E((M=t(f))==null?void 0:M.style)},null,4)],4)}}}),nt=`:host{aspect-ratio:var(--45b79bca)/var(--45b79b8c)}:host>.root{width:100%;height:100%}@supports not (aspect-ratio: auto){:host:before{float:left;padding-top:calc(var(--45b79b8c) / var(--45b79bca) * 100%);content:""}:host:after{display:block;clear:both;content:""}:host>div{position:absolute;top:0;left:0}}.root{display:grid;grid-template:repeat(var(--8cfe600e),1fr)/repeat(var(--942609d2),1fr);gap:var(--3745303b)}.player{grid-area:var(--62329918)/var(--cbff0f9a)/calc(var(--62329918) + var(--5e6f977e))/calc(var(--cbff0f9a) + var(--29895c3d))}.player>div{position:absolute!important;top:0!important;left:0!important;width:100%!important;height:100%!important}.player>iframe{position:absolute!important;top:0!important;left:0!important;width:100%!important;height:100%!important}.player video{-o-object-fit:cover;object-fit:cover}.ad{grid-area:var(--2593c238)/var(--1ea4f216)/calc(var(--2593c238) + var(--0664a87a))/calc(var(--1ea4f216) + var(--5d03258e));display:grid;align-self:center;justify-self:flex-start;margin-left:2rem;font-size:.875rem;color:var(--color-600);mix-blend-mode:exclusion}.volume{grid-area:var(--3a2bdbaf)/var(--0545a06e)/calc(var(--3a2bdbaf) + var(--a78ff7ba))/calc(var(--0545a06e) + var(--7751c8e2));display:grid;align-self:center;justify-self:flex-end;width:24pt;height:24pt;margin-right:2rem;color:var(--color-600);cursor:pointer;mix-blend-mode:exclusion}.progress{grid-area:var(--8c00bffc)/var(--f5cd3682)/calc(var(--8c00bffc) + var(--5580e972))/calc(var(--f5cd3682) + var(--209aae31));align-self:flex-end;width:var(--139a8a02);height:.25rem;background:var(--color-600-80);-webkit-backdrop-filter:blur(.25rem);backdrop-filter:blur(.25rem);border-radius:.125rem;mix-blend-mode:exclusion;will-change:width;transition:width var(--duration-fast) var(--ease-default)}
`,rt=ze(st,[["styles",[nt]]]);export{rt as default};
