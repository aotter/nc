import{i as F,e as s,g as Y,a as j,s as q,p as z}from"./0f44fc6b.js";import{C as y,T as p,I as h,a as g,P as k,R as O,_ as C,S as I}from"./43b0c463.js";import{L as G}from"./2040bebd.js";import{P as J,Q as K,a as P,w as E}from"./903daaf2.js";var V=/\s/;function X(t){for(var e=t.length;e--&&V.test(t.charAt(e)););return e}var Z=/^\s+/;function tt(t){return t&&t.slice(0,X(t)+1).replace(Z,"")}var U=0/0,et=/^[-+]0x[0-9a-f]+$/i,nt=/^0b[01]+$/i,rt=/^0o[0-7]+$/i,it=parseInt;function R(t){if(typeof t=="number")return t;if(J(t))return U;if(F(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=F(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=tt(t);var n=nt.test(t);return n||rt.test(t)?it(t.slice(2),n?2:8):et.test(t)?U:+t}function ot(t,e,n){return t===t&&(n!==void 0&&(t=t<=n?t:n),e!==void 0&&(t=t>=e?t:e)),t}function at(t,e,n){return n===void 0&&(n=e,e=void 0),n!==void 0&&(n=R(n),n=n===n?n:0),e!==void 0&&(e=R(e),e=e===e?e:0),ot(R(t),e,n)}var st=function(){return K.Date.now()};const M=st;var lt="Expected a function",ct=Math.max,ut=Math.min;function ft(t,e,n){var r,o,l,c,i,u,f=0,d=!1,m=!1,w=!0;if(typeof t!="function")throw new TypeError(lt);e=R(e)||0,F(n)&&(d=!!n.leading,m="maxWait"in n,l=m?ct(R(n.maxWait)||0,e):l,w="trailing"in n?!!n.trailing:w);function T(a){var v=r,b=o;return r=o=void 0,f=a,c=t.apply(b,v),c}function A(a){return f=a,i=setTimeout(H,e),d?T(a):c}function D(a){var v=a-u,b=a-f,S=e-v;return m?ut(S,l-b):S}function $(a){var v=a-u,b=a-f;return u===void 0||v>=e||v<0||m&&b>=l}function H(){var a=M();if($(a))return B(a);i=setTimeout(H,D(a))}function B(a){return i=void 0,w&&r?T(a):(r=o=void 0,c)}function N(){i!==void 0&&clearTimeout(i),f=0,r=u=o=i=void 0}function Q(){return i===void 0?c:B(M())}function L(){var a=M(),v=$(a);if(r=arguments,o=this,u=a,v){if(i===void 0)return A(u);if(m)return clearTimeout(i),i=setTimeout(H,e),T(u)}return i===void 0&&(i=setTimeout(H,e)),c}return L.cancel=N,L.flush=Q,L}var mt="Expected a function";function _(t,e,n){var r=!0,o=!0;if(typeof t!="function")throw new TypeError(mt);return F(n)&&(r="leading"in n?!!n.leading:r,o="trailing"in n?!!n.trailing:o),ft(t,e,{leading:r,maxWait:e,trailing:o})}const x={[y]:t=>{s.emit(y,t);const{type:e,tracks:n=[]}=t;switch(x[p]({name:y,tracks:n}),e){case G:{const{url:r}=t;P.open(r,"_blank");break}}},[h]:t=>{s.emit(h,t)},[g]:(t,e)=>{s.emit(g,t,e)},[k]:t=>{s.emit(k,t)},[O]:(t,e)=>{const{extractColorElement:n,color:r}=e||{},o=r?Y(r):n?j(n):[],{expensiveEvents:l=[],preloadUrls:c=[]}=t,i={colorPalette:o,expensiveEvents:l,preloadUrls:c.filter(Boolean)};s.emit(O,i),x[C](i)},[I]:t=>{s.emit(I,t)},[p]:t=>{s.emit(p,t),q(t.tracks)},[C]:t=>{s.emit(C,t)}},dt=()=>{let t=P,e=null;for(;t&&t.frameElement;)e=t.frameElement,t=t.parent.window;return e},vt=()=>P.frameElement?P.frameElement:null,gt=t=>{let e=t?.parentElement||null;for(;e;){const n=e.scrollHeight>e.clientHeight,r=E.getComputedStyle(e).overflowY.indexOf("hidden")!==-1;if(n&&!r)return e;e=e.parentElement}return E.document.documentElement},pt=()=>{const t=[];for(let e=0;e<1.01;e+=.01)t.push(+e.toFixed(2));return t},W={[y]:t=>{s.on(y,t)},[h]:(t,e)=>{s.once(h,t);const{impressions:n=[],target:r}=e||{},o=[...n],l=[],c=({intersectionRatio:i,isIntersecting:u},f)=>{if(!o.length){f?.unobserve(r);return}u&&o.forEach((d,m)=>{clearTimeout(l[m]);const{settings:{ratio:w=.5,remain:T=1e3},tracks:A=[]}=d;i>=w&&(l[m]=setTimeout(()=>{x[p]({name:h,tracks:A}),z(o,m),x[h](n)},T))})};W[g](c,{target:r})},[g]:(t,e)=>{s.on(g,t);const n=vt(),{target:r=n,threshold:o}=e||{},l={root:null,rootMargin:"0px",threshold:o||pt()},c=([u],f)=>{const{isIntersecting:d,intersectionRatio:m}=u;x[g]({intersectionRatio:+m.toFixed(2),isIntersecting:d},f)},i=new IntersectionObserver(c,l);r&&i.observe(r)},[k]:t=>{s.on(k,t);const e=dt(),n=gt(e),r=()=>{const{top:i=0,height:u=0}=e?.getBoundingClientRect()||{},f=(i+u)/(n.clientHeight+u),d=+at(1-f,0,1).toFixed(2);s.emit(k,{positionRatio:d})},o=n===E.document.documentElement?E:n;let l=new AbortController;const c=_(({isIntersecting:i})=>{i?o.addEventListener("scroll",r,{passive:!0,signal:l.signal}):(l.abort(),l=new AbortController)},100);W[g](c,{threshold:[0]})},[O]:t=>{s.once(O,t)},[I]:t=>{s.on(I,t),E.addEventListener("scroll",_(()=>{const{scrollTop:e,clientHeight:n,scrollHeight:r}=E.document.documentElement,o=+(e/(r-n)).toFixed(2);s.emit(I,{scrollRatio:o})},100),{passive:!0})},[p]:t=>{s.on(p,t)},[C]:t=>{s.once(C,t)}};export{x as emit,W as on};
