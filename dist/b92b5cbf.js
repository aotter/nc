var Rt=Object.defineProperty,_t=(a,t,i)=>t in a?Rt(a,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[t]=i,n=(a,t,i)=>(_t(a,typeof t!="symbol"?t+"":t,i),i);import{b as L,c as R,f as h,a as xt,d as Ct,r as _,o as Dt,n as M,u as e,t as qt,j as Tt,k as Pt,l as jt}from"./563e8bda.js";import{a as Ht}from"./9837cbe8.js";import{b as Ot,u as St,c as Vt}from"./498c4cd5.js";import{u as It}from"./96a43d88.js";import{u as Wt}from"./da2e3a0e.js";import{u as Ft}from"./9e21d7bb.js";import{_ as zt}from"./66dda505.js";const Bt={xmlns:"http://www.w3.org/2000/svg",fill:"none","stroke-width":"1.5",viewBox:"0 0 24 24"},Nt=h("path",{stroke:"currentColor",d:"M2 14v-4a1 1 0 0 1 1-1h2.697a1 1 0 0 0 .555-.168l4.193-2.796A1 1 0 0 1 12 6.87V17.13a1 1 0 0 1-1.555.832l-4.193-2.795A1 1 0 0 0 5.697 15H3a1 1 0 0 1-1-1Z"},null,-1),Zt=h("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round",d:"M16.5 7.5S18 9 18 11.5s-1.5 4-1.5 4M19.5 4.5S22 7 22 11.5s-2.5 7-2.5 7"},null,-1),Gt=[Nt,Zt];function Ut(a,t){return L(),R("svg",Bt,Gt)}const $t={render:Ut},Jt={xmlns:"http://www.w3.org/2000/svg",fill:"none","stroke-width":"1.5",viewBox:"0 0 24 24"},Kt=h("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round",d:"m17 14 2-2m2-2-2 2m0 0-2-2m2 2 2 2"},null,-1),Qt=h("path",{stroke:"currentColor",d:"M3 14v-4a1 1 0 0 1 1-1h2.697a1 1 0 0 0 .555-.168l4.193-2.796A1 1 0 0 1 13 6.87V17.13a1 1 0 0 1-1.555.832l-4.193-2.795A1 1 0 0 0 6.697 15H4a1 1 0 0 1-1-1Z"},null,-1),Xt=[Kt,Qt];function Yt(a,t){return L(),R("svg",Jt,Xt)}const te={render:Yt};var ee=function(a){return new Promise(function(t,i){var o=document.createElement("script");o.async=!0,o.src=a,o.onload=t,o.onerror=i,document.body.appendChild(o)})},ie="https://imasdk.googleapis.com/js/sdkloader/ima3.js",E=null,Mt=function(){E=null},ae=function(){var a=window;return a.google&&a.google.ima?Promise.resolve(a.google.ima):E||(E=ee(ie).then(function(){return a.google.ima}),E.then(Mt).catch(Mt),E)};class oe{constructor(){n(this,"_playing",!1),n(this,"_started",!1),n(this,"_muted",!0),n(this,"_config",{}),n(this,"ima"),n(this,"adDisplayContainer"),n(this,"adsLoader"),n(this,"adsRequest"),n(this,"adsManager"),n(this,"currentAd",null),n(this,"playHeadAnimationRequestId",null)}get playing(){return this._playing}set playing(t){this._playing=t}get started(){return this._started}set started(t){this._started=t}get muted(){return this._muted}set muted(t){this._muted=t}get config(){return this._config}set config(t){this._config=t}async init(t,i){const o=await ae();this.ima=o,this.config=i;const s=xt.navigator.language.replace("-","_").toLowerCase()||"en";this.ima.settings.setLocale(s),this.adDisplayContainer=new this.ima.AdDisplayContainer(t),this.adDisplayContainer.initialize(),this.adsLoader=new this.ima.AdsLoader(this.adDisplayContainer),this.adsRequest=new this.ima.AdsRequest;const{url:l,xml:d}=this.config;l&&(this.adsRequest.adTagUrl=l),d&&(this.adsRequest.adsResponse=d),this.adsLoader.requestAds(this.adsRequest),this.adsLoader.addEventListener(this.ima.AdErrorEvent.Type.AD_ERROR,this.onAdError,!1),this.adsLoader.addEventListener(this.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,this.onAdsManagerLoaded.bind(this),!1)}onAdsManagerLoaded(t){this.adsManager=t.getAdsManager({currentTime:0,duration:0},{enablePreloading:!0,uiElements:[]}),this.adsManager.addEventListener(this.ima.AdErrorEvent.Type.AD_ERROR,this.onAdError.bind(this)),this.adsManager.addEventListener(this.ima.AdEvent.Type.ALL_ADS_COMPLETED,this.onAllAdsCompleted.bind(this)),this.adsManager.addEventListener(this.ima.AdEvent.Type.LOADED,this.onLoaded.bind(this)),this.adsManager.addEventListener(this.ima.AdEvent.Type.STARTED,this.onStarted.bind(this)),this.adsManager.init(0,0,this.ima.ViewMode.NORMAL),this.adsManager.setVolume(this.muted?0:1)}onStarted(t){this.currentAd=t.getAd(),this.started=!0}onLoaded(){var t,i;this.started?this.adsManager.start():(i=(t=this.config).playbackController)==null||i.call(t)}onAllAdsCompleted(){this.adsLoader.requestAds(this.adsRequest)}onAdError(t){console.error(t.getError()),this.destroy()}play(){this.playing=!0,this.startWatchProgress(),this.started?this.adsManager.resume():this.adsManager.start()}pause(){this.playing=!1,this.stopWatchProgress(),this.adsManager.pause()}toggleMute(){return this.muted?this.unmute():this.mute(),this.muted}mute(){return this.muted=!0,this.adsManager.setVolume(0),this.muted}unmute(){return this.muted=!1,this.adsManager.setVolume(1),this.muted}startWatchProgress(){this.stopWatchProgress();const t=()=>{var i,o,s,l;const d=+this.adsManager.getRemainingTime(),v=((o=(i=this.currentAd)==null?void 0:i.getDuration)==null?void 0:o.call(i))||0;let r=v-d;r=r>0?+r:0;const c=+(r/v)||0;(l=(s=this.config).onProgress)==null||l.call(s,{currentTime:r,duration:v,progress:c,remainingTime:d}),this.playHeadAnimationRequestId=requestAnimationFrame(t)};this.playHeadAnimationRequestId=requestAnimationFrame(t)}stopWatchProgress(){this.playHeadAnimationRequestId&&cancelAnimationFrame(this.playHeadAnimationRequestId)}destroy(){var t,i,o,s,l,d;(i=(t=this.adDisplayContainer).destroy)==null||i.call(t),(s=(o=this.adsManager).destroy)==null||s.call(o),(d=(l=this.adsLoader).destroy)==null||d.call(l),this.stopWatchProgress()}}const se=Ct({__name:"Vast.ce",setup(a){jt(k=>{var f,u,y,b,A,w,x,C,D,q,T,P,j,H,O,S,V,I,W,F,z,B,N,Z,G,U,$,J,K,Q,X,Y,tt,et,it,at,ot,st,rt,nt,lt,dt,ut,ct,ht,vt,pt,mt,gt,ft,yt,bt,At,wt;return{"63714f79":((u=(f=e(r))==null?void 0:f.grid)==null?void 0:u.columns)||3,"86acb252":((b=(y=e(r))==null?void 0:y.grid)==null?void 0:b.rows)||3,"1657059d":((w=(A=e(r))==null?void 0:A.grid)==null?void 0:w.gap)||0,"953f0dd6":((D=(C=(x=e(p))==null?void 0:x.position)==null?void 0:C.coordinate)==null?void 0:D[0])||1,"2b729754":((P=(T=(q=e(p))==null?void 0:q.position)==null?void 0:T.coordinate)==null?void 0:P[1])||1,"60d691ca":((O=(H=(j=e(p))==null?void 0:j.position)==null?void 0:H.dimension)==null?void 0:O[0])||3,"047af25c":((I=(V=(S=e(p))==null?void 0:S.position)==null?void 0:V.dimension)==null?void 0:I[1])||3,d9356e52:((z=(F=(W=e(c))==null?void 0:W.position)==null?void 0:F.coordinate)==null?void 0:z[0])||1,"6f68f7cc":((Z=(N=(B=e(c))==null?void 0:B.position)==null?void 0:N.coordinate)==null?void 0:Z[1])||3,"949431d2":(($=(U=(G=e(c))==null?void 0:G.position)==null?void 0:U.dimension)==null?void 0:$[0])||1,"2ac7bb50":((Q=(K=(J=e(c))==null?void 0:J.position)==null?void 0:K.dimension)==null?void 0:Q[1])||1,"20a5a150":((tt=(Y=(X=e(m))==null?void 0:X.position)==null?void 0:Y.coordinate)==null?void 0:tt[0])||3,"558bdc91":((at=(it=(et=e(m))==null?void 0:et.position)==null?void 0:it.coordinate)==null?void 0:at[1])||3,"1d5d23c0":((rt=(st=(ot=e(m))==null?void 0:ot.position)==null?void 0:st.dimension)==null?void 0:rt[0])||1,"52435f01":((dt=(lt=(nt=e(m))==null?void 0:nt.position)==null?void 0:lt.dimension)==null?void 0:dt[1])||1,"487cb521":((ht=(ct=(ut=e(g))==null?void 0:ut.position)==null?void 0:ct.coordinate)==null?void 0:ht[0])||1,"7d62f064":((mt=(pt=(vt=e(g))==null?void 0:vt.position)==null?void 0:pt.coordinate)==null?void 0:mt[1])||3,"713ac98f":((yt=(ft=(gt=e(g))==null?void 0:gt.position)==null?void 0:ft.dimension)==null?void 0:yt[0])||3,b3bdf660:((wt=(At=(bt=e(g))==null?void 0:bt.position)==null?void 0:At.dimension)==null?void 0:wt[1])||3,"02f36038":o.value}});const t=_(),i=_(!0),o=_("0%"),s=new oe,{t:l}=Wt(),{bridge:d}=Vt(),{type:{dimension:v},properties:{root:r,ad:c,player:p,volume:m,progress:g}}=Ft();Ot(v);const Et=St(),{handleReady:Lt}=It();Dt(()=>{const{xml:k,url:f}=r.settings;s.init(t.value,{onProgress:u=>{o.value=`${u.progress*100}%`},playbackController:()=>{d("on",Ht,({isIntersecting:u})=>{u?s.play():s.pause()},{target:Et.value,threshold:[0]}),Lt()},url:f,xml:k})});const kt=()=>{i.value=s.toggleMute()};return(k,f)=>{var u,y,b,A,w;return L(),R("div",{class:"root",style:M(e(r).style)},[h("div",{ref_key:"playerRef",ref:t,role:"link",class:"player",style:M((u=e(p))==null?void 0:u.style)},null,4),h("p",{class:"ad",style:M((y=e(c))==null?void 0:y.style)},qt(((b=e(c))==null?void 0:b.text.content)||e(l)("ad")),5),(L(),Tt(Pt(i.value?e(te):e($t)),{role:"button",class:"volume",style:M((A=e(m))==null?void 0:A.style),onClick:kt},null,8,["style"])),h("div",{class:"progress",style:M((w=e(g))==null?void 0:w.style)},null,4)],4)}}}),re=`:host{display:block}:host>.root{width:100%;aspect-ratio:var(--width)/var(--height)}@supports not (aspect-ratio: auto){:host{position:relative;padding-top:calc(var(--height) / var(--width) * 100%)}:host>.root{position:absolute;top:0;left:0;width:100%;height:100%}}.root{display:grid;grid-template:repeat(var(--86acb252),1fr)/repeat(var(--63714f79),1fr);gap:var(--1657059d)}.player{position:relative;grid-area:var(--2b729754)/var(--953f0dd6)/calc(var(--2b729754) + var(--047af25c))/calc(var(--953f0dd6) + var(--60d691ca))}.player>div{position:absolute!important;top:0!important;left:0!important;width:100%!important;height:100%!important}.player>iframe{position:absolute!important;top:0!important;left:0!important;width:100%!important;height:100%!important}.player video{-o-object-fit:cover;object-fit:cover}.ad{grid-area:var(--6f68f7cc)/var(--d9356e52)/calc(var(--6f68f7cc) + var(--2ac7bb50))/calc(var(--d9356e52) + var(--949431d2));display:grid;align-self:center;justify-self:flex-start;margin-left:2rem;font-size:.875rem;color:var(--color-600);mix-blend-mode:exclusion}.volume{grid-area:var(--558bdc91)/var(--20a5a150)/calc(var(--558bdc91) + var(--52435f01))/calc(var(--20a5a150) + var(--1d5d23c0));display:grid;align-self:center;justify-self:flex-end;width:24pt;height:24pt;margin-right:2rem;color:var(--color-600);cursor:pointer;mix-blend-mode:exclusion}.progress{grid-area:var(--7d62f064)/var(--487cb521)/calc(var(--7d62f064) + var(--b3bdf660))/calc(var(--487cb521) + var(--713ac98f));align-self:flex-end;width:var(--02f36038);height:.25rem;background:var(--color-600-80);-webkit-backdrop-filter:blur(.25rem);backdrop-filter:blur(.25rem);border-radius:.125rem;mix-blend-mode:exclusion;will-change:width;transition:width var(--duration-fast) var(--ease-default)}
`,ne=zt(se,[["styles",[re]]]);export{ne as default};
