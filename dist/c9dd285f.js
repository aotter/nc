import{i as R,e as l,g as S,a as Y,s as j,p as q}from"./91b0c968.js";import{C as b,T as p,I as h,a as g,P as y,R as F,_ as C}from"./9837cbe8.js";import{L as z}from"./2040bebd.js";import{P as G,Q as J,a as O,w as P}from"./006b9ff7.js";var K=/\s/;function N(t){for(var e=t.length;e--&&K.test(t.charAt(e)););return e}var V=/^\s+/;function X(t){return t&&t.slice(0,N(t)+1).replace(V,"")}var U=0/0,Z=/^[-+]0x[0-9a-f]+$/i,tt=/^0b[01]+$/i,et=/^0o[0-7]+$/i,nt=parseInt;function k(t){if(typeof t=="number")return t;if(G(t))return U;if(R(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=R(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=X(t);var n=tt.test(t);return n||et.test(t)?nt(t.slice(2),n?2:8):Z.test(t)?U:+t}function rt(t,e,n){return t===t&&(n!==void 0&&(t=t<=n?t:n),e!==void 0&&(t=t>=e?t:e)),t}function it(t,e,n){return n===void 0&&(n=e,e=void 0),n!==void 0&&(n=k(n),n=n===n?n:0),e!==void 0&&(e=k(e),e=e===e?e:0),rt(k(t),e,n)}var ot=function(){return J.Date.now()};const M=ot;var at="Expected a function",st=Math.max,lt=Math.min;function ut(t,e,n){var r,o,s,u,i,c,f=0,v=!1,m=!1,x=!0;if(typeof t!="function")throw new TypeError(at);e=k(e)||0,R(n)&&(v=!!n.leading,m="maxWait"in n,s=m?st(k(n.maxWait)||0,e):s,x="trailing"in n?!!n.trailing:x);function w(a){var d=r,T=o;return r=o=void 0,f=a,u=t.apply(T,d),u}function A(a){return f=a,i=setTimeout(I,e),v?w(a):u}function _(a){var d=a-c,T=a-f,L=e-d;return m?lt(L,s-T):L}function $(a){var d=a-c,T=a-f;return c===void 0||d>=e||d<0||m&&T>=s}function I(){var a=M();if($(a))return B(a);i=setTimeout(I,_(a))}function B(a){return i=void 0,x&&r?w(a):(r=o=void 0,u)}function D(){i!==void 0&&clearTimeout(i),f=0,r=c=o=i=void 0}function Q(){return i===void 0?u:B(M())}function H(){var a=M(),d=$(a);if(r=arguments,o=this,c=a,d){if(i===void 0)return A(c);if(m)return clearTimeout(i),i=setTimeout(I,e),w(c)}return i===void 0&&(i=setTimeout(I,e)),u}return H.cancel=D,H.flush=Q,H}var ct="Expected a function";function ft(t,e,n){var r=!0,o=!0;if(typeof t!="function")throw new TypeError(ct);return R(n)&&(r="leading"in n?!!n.leading:r,o="trailing"in n?!!n.trailing:o),ut(t,e,{leading:r,maxWait:e,trailing:o})}const E={[b]:t=>{l.emit(b,t);const{type:e,tracks:n=[]}=t;switch(E[p]({name:b,tracks:n}),e){case z:{const{url:r}=t;O.open(r,"_blank");break}}},[h]:t=>{l.emit(h,t)},[g]:(t,e)=>{l.emit(g,t,e)},[y]:t=>{l.emit(y,t)},[F]:(t,e)=>{const{extractColorElement:n,color:r}=e||{},o=r?S(r):n?Y(n):[],{expensiveEvents:s=[],preloadUrls:u=[]}=t,i={colorPalette:o,expensiveEvents:s,preloadUrls:u.filter(Boolean)};l.emit(F,i),E[C](i)},[p]:t=>{l.emit(p,t),j(t.tracks)},[C]:t=>{l.emit(C,t)}},mt=()=>{let t=O,e=null;for(;t&&t.frameElement;)e=t.frameElement,t=t.parent.window;return e},vt=()=>O.frameElement?O.frameElement:null,dt=t=>{let e=t?.parentElement||null;for(;e;){const n=e.scrollHeight>e.clientHeight,r=P.getComputedStyle(e).overflowY.indexOf("hidden")!==-1;if(n&&!r)return e;e=e.parentElement}return P.document.documentElement},gt=()=>{const t=[];for(let e=0;e<1.01;e+=.01)t.push(+e.toFixed(2));return t},W={[b]:t=>{l.on(b,t)},[h]:(t,e)=>{l.once(h,t);const{impressions:n=[],target:r}=e||{},o=[...n],s=[],u=({intersectionRatio:i,isIntersecting:c},f)=>{if(!o.length){f?.unobserve(r);return}c&&o.forEach((v,m)=>{clearTimeout(s[m]);const{settings:{ratio:x=.5,remain:w=1e3},tracks:A=[]}=v;i>=x&&(s[m]=setTimeout(()=>{E[p]({name:h,tracks:A}),q(o,m),E[h](n)},w))})};W[g](u,{target:r})},[g]:(t,e)=>{l.on(g,t);const n=vt(),{target:r=n,threshold:o}=e||{},s={root:null,rootMargin:"0px",threshold:o||gt()},u=([c],f)=>{const{isIntersecting:v,intersectionRatio:m}=c;E[g]({intersectionRatio:+m.toFixed(2),isIntersecting:v},f)},i=new IntersectionObserver(u,s);r&&i.observe(r)},[y]:t=>{l.on(y,t);const e=mt(),n=dt(e),r=()=>{const{top:i=0,height:c=0}=e?.getBoundingClientRect()||{},f=(i+c)/(n.clientHeight+c),v=+it(1-f,0,1).toFixed(2);l.emit(y,{positionRatio:v})},o=n===P.document.documentElement?P:n;let s=new AbortController;const u=ft(({isIntersecting:i})=>{i?o.addEventListener("scroll",r,{passive:!0,signal:s.signal}):(s.abort(),s=new AbortController)},100);W[g](u,{threshold:[0]})},[F]:t=>{l.once(F,t)},[p]:t=>{l.on(p,t)},[C]:t=>{l.once(C,t)}};export{E as emit,W as on};
