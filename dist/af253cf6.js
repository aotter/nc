import{i as I,e as u,g as Y,a as _,s as j,p as q}from"./1bca2f4c.js";import{C as T,T as p,I as h,a as g,P as b,R}from"./1236a3b0.js";import{L as z}from"./2040bebd.js";import{S as G,P as J,a as A,w as F}from"./73fb6fc3.js";var K=/\s/;function N(t){for(var e=t.length;e--&&K.test(t.charAt(e)););return e}var Q=/^\s+/;function V(t){return t&&t.slice(0,N(t)+1).replace(Q,"")}var L=0/0,X=/^[-+]0x[0-9a-f]+$/i,Z=/^0b[01]+$/i,tt=/^0o[0-7]+$/i,et=parseInt;function y(t){if(typeof t=="number")return t;if(G(t))return L;if(I(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=I(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=V(t);var n=Z.test(t);return n||tt.test(t)?et(t.slice(2),n?2:8):X.test(t)?L:+t}function nt(t,e,n){return t===t&&(n!==void 0&&(t=t<=n?t:n),e!==void 0&&(t=t>=e?t:e)),t}function rt(t,e,n){return n===void 0&&(n=e,e=void 0),n!==void 0&&(n=y(n),n=n===n?n:0),e!==void 0&&(e=y(e),e=e===e?e:0),nt(y(t),e,n)}var it=function(){return J.Date.now()};const M=it;var ot="Expected a function",at=Math.max,st=Math.min;function ct(t,e,n){var r,o,s,c,i,l,f=0,v=!1,m=!1,E=!0;if(typeof t!="function")throw new TypeError(ot);e=y(e)||0,I(n)&&(v=!!n.leading,m="maxWait"in n,s=m?at(y(n.maxWait)||0,e):s,E="trailing"in n?!!n.trailing:E);function x(a){var d=r,w=o;return r=o=void 0,f=a,c=t.apply(w,d),c}function O(a){return f=a,i=setTimeout(k,e),v?x(a):c}function S(a){var d=a-l,w=a-f,B=e-d;return m?st(B,s-w):B}function W(a){var d=a-l,w=a-f;return l===void 0||d>=e||d<0||m&&w>=s}function k(){var a=M();if(W(a))return $(a);i=setTimeout(k,S(a))}function $(a){return i=void 0,E&&r?x(a):(r=o=void 0,c)}function U(){i!==void 0&&clearTimeout(i),f=0,r=l=o=i=void 0}function D(){return i===void 0?c:$(M())}function H(){var a=M(),d=W(a);if(r=arguments,o=this,l=a,d){if(i===void 0)return O(l);if(m)return clearTimeout(i),i=setTimeout(k,e),x(l)}return i===void 0&&(i=setTimeout(k,e)),c}return H.cancel=U,H.flush=D,H}var lt="Expected a function";function ut(t,e,n){var r=!0,o=!0;if(typeof t!="function")throw new TypeError(lt);return I(n)&&(r="leading"in n?!!n.leading:r,o="trailing"in n?!!n.trailing:o),ct(t,e,{leading:r,maxWait:e,trailing:o})}const C={[T]:t=>{u.emit(T,t);const{type:e,tracks:n=[]}=t;switch(C[p]({name:T,tracks:n}),e){case z:{const{url:r}=t;A.open(r,"_blank");break}}},[h]:t=>{u.emit(h,t)},[g]:(t,e)=>{u.emit(g,t,e)},[b]:t=>{u.emit(b,t)},[R]:(t,e)=>{const{extractColorElement:n,color:r}=e||{},o=r?Y(r):n?_(n):[],{expensiveEvents:s=[],preloadUrls:c=[]}=t;u.emit(R,{colorPalette:o,expensiveEvents:s,preloadUrls:c.filter(Boolean)})},[p]:t=>{u.emit(p,t),j(t.tracks)}},ft=()=>{let t=A,e=null;for(;t&&t.frameElement;)e=t.frameElement,t=t.parent.window;return e},mt=()=>A.frameElement?A.frameElement:null,vt=t=>{let e=t?.parentElement||null;for(;e;){const n=e.scrollHeight>e.clientHeight,r=F.getComputedStyle(e).overflowY.indexOf("hidden")!==-1;if(n&&!r)return e;e=e.parentElement}return F.document.documentElement},dt=()=>{const t=[];for(let e=0;e<1.01;e+=.01)t.push(+e.toFixed(2));return t},P={[T]:t=>{u.on(T,t)},[h]:(t,e)=>{u.once(h,t);const{impressions:n=[],target:r}=e||{},o=[...n],s=[],c=({intersectionRatio:i,isIntersecting:l},f)=>{if(!o.length){f?.unobserve(r);return}l&&o.forEach((v,m)=>{clearTimeout(s[m]);const{settings:{ratio:E=.5,remain:x=1e3},tracks:O=[]}=v;i>=E&&(s[m]=setTimeout(()=>{C[p]({name:h,tracks:O}),q(o,m),C[h](n)},x))})};P[g](c,{target:r})},[g]:(t,e)=>{u.on(g,t);const n=mt(),{target:r=n,threshold:o}=e||{},s={root:null,rootMargin:"0px",threshold:o||dt()},c=([l],f)=>{const{isIntersecting:v,intersectionRatio:m}=l;C[g]({intersectionRatio:+m.toFixed(2),isIntersecting:v},f)},i=new IntersectionObserver(c,s);r&&i.observe(r)},[b]:t=>{u.on(b,t);const e=ft(),n=vt(e),r=()=>{const{top:i=0,height:l=0}=e?.getBoundingClientRect()||{},f=(i+l)/(n.clientHeight+l),v=+rt(1-f,0,1).toFixed(2);u.emit(b,{positionRatio:v})},o=n===F.document.documentElement?F:n;let s=new AbortController;const c=ut(({isIntersecting:i})=>{i?o.addEventListener("scroll",r,{passive:!0,signal:s.signal}):(s.abort(),s=new AbortController)},100);P[g](c,{threshold:[0]})},[R]:t=>{u.once(R,t)},[p]:t=>{u.on(p,t)}};export{C as emit,P as on};
