var ke=Object.defineProperty,Ce=(o,e,i)=>e in o?ke(o,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):o[e]=i,n=(o,e,i)=>(Ce(o,typeof e!="symbol"?e+"":e,i),i);import{b as R,c as k,f as h,d as De,r as C,o as qe,a as xe,n as L,u as t,t as Te,i as Pe,j as je,k as Oe}from"./0381570b.js";import{a as Se}from"./1236a3b0.js";import{u as Ve}from"./154cbf94.js";import{a as Ie}from"./78b8fe3e.js";import{u as We,a as Fe}from"./bf5ea06e.js";import{u as ze}from"./525897ec.js";import{_ as Be}from"./66dda505.js";const He={xmlns:"http://www.w3.org/2000/svg",fill:"none","stroke-width":"1.5",viewBox:"0 0 24 24"},Ne=h("path",{stroke:"currentColor",d:"M2 14v-4a1 1 0 0 1 1-1h2.697a1 1 0 0 0 .555-.168l4.193-2.796A1 1 0 0 1 12 6.87V17.13a1 1 0 0 1-1.555.832l-4.193-2.795A1 1 0 0 0 5.697 15H3a1 1 0 0 1-1-1Z"},null,-1),Ze=h("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round",d:"M16.5 7.5S18 9 18 11.5s-1.5 4-1.5 4M19.5 4.5S22 7 22 11.5s-2.5 7-2.5 7"},null,-1),Ge=[Ne,Ze];function Ue(o,e){return R(),k("svg",He,Ge)}const $e={render:Ue},Je={xmlns:"http://www.w3.org/2000/svg",fill:"none","stroke-width":"1.5",viewBox:"0 0 24 24"},Ke=h("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round",d:"m17 14 2-2m2-2-2 2m0 0-2-2m2 2 2 2"},null,-1),Qe=h("path",{stroke:"currentColor",d:"M3 14v-4a1 1 0 0 1 1-1h2.697a1 1 0 0 0 .555-.168l4.193-2.796A1 1 0 0 1 13 6.87V17.13a1 1 0 0 1-1.555.832l-4.193-2.795A1 1 0 0 0 6.697 15H4a1 1 0 0 1-1-1Z"},null,-1),Xe=[Ke,Qe];function Ye(o,e){return R(),k("svg",Je,Xe)}const et={render:Ye};var tt=function(o){return new Promise(function(e,i){var a=document.createElement("script");a.async=!0,a.src=o,a.onload=e,a.onerror=i,document.body.appendChild(a)})},it="https://imasdk.googleapis.com/js/sdkloader/ima3.js",E=null,Le=function(){E=null},at=function(){var o=window;return o.google&&o.google.ima?Promise.resolve(o.google.ima):E||(E=tt(it).then(function(){return o.google.ima}),E.then(Le).catch(Le),E)};class ot{constructor(){n(this,"_playing",!1),n(this,"_started",!1),n(this,"_muted",!0),n(this,"_config",{}),n(this,"ima"),n(this,"adDisplayContainer"),n(this,"adsLoader"),n(this,"adsRequest"),n(this,"adsManager"),n(this,"currentAd",null),n(this,"playheadAnimationRequestId",null)}get playing(){return this._playing}set playing(e){this._playing=e}get started(){return this._started}set started(e){this._started=e}get muted(){return this._muted}set muted(e){this._muted=e}get config(){return this._config}set config(e){this._config=e}async init(e,i){const a=await at();this.ima=a,this.config=i;const s=window.navigator.language.replace("-","_").toLowerCase()||"en";this.ima.settings.setLocale(s),this.adDisplayContainer=new this.ima.AdDisplayContainer(e),this.adDisplayContainer.initialize(),this.adsLoader=new this.ima.AdsLoader(this.adDisplayContainer),this.adsRequest=new this.ima.AdsRequest;const{url:r,xml:l}=this.config;r&&(this.adsRequest.adTagUrl=r),l&&(this.adsRequest.adsResponse=l),this.adsLoader.requestAds(this.adsRequest),this.adsLoader.addEventListener(this.ima.AdErrorEvent.Type.AD_ERROR,this.onAdError,!1),this.adsLoader.addEventListener(this.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,this.onAdsManagerLoaded.bind(this),!1)}onAdsManagerLoaded(e){this.adsManager=e.getAdsManager({currentTime:0,duration:0},{enablePreloading:!0,uiElements:[]}),this.adsManager.addEventListener(this.ima.AdErrorEvent.Type.AD_ERROR,this.onAdError.bind(this)),this.adsManager.addEventListener(this.ima.AdEvent.Type.ALL_ADS_COMPLETED,this.onAllAdsCompleted.bind(this)),this.adsManager.addEventListener(this.ima.AdEvent.Type.LOADED,this.onLoaded.bind(this)),this.adsManager.addEventListener(this.ima.AdEvent.Type.STARTED,this.onStarted.bind(this)),this.adsManager.init(0,0,this.ima.ViewMode.NORMAL),this.adsManager.setVolume(this.muted?0:1)}onStarted(e){this.currentAd=e.getAd(),this.started=!0}onLoaded(){var e,i;this.started?this.adsManager.start():(i=(e=this.config).playbackController)==null||i.call(e)}onAllAdsCompleted(){this.adsLoader.requestAds(this.adsRequest)}onAdError(e){var i,a;console.log(e.getError()),(a=(i=this.adsManager).destroy)==null||a.call(i)}play(){this.playing=!0,this.startWatchProgress(),this.started?this.adsManager.resume():this.adsManager.start()}pause(){this.playing=!1,this.stopWatchProgress(),this.adsManager.pause()}toggleMute(){return this.muted?this.unmute():this.mute(),this.muted}mute(){return this.muted=!0,this.adsManager.setVolume(0),this.muted}unmute(){return this.muted=!1,this.adsManager.setVolume(1),this.muted}startWatchProgress(){this.stopWatchProgress();const e=()=>{var i,a,s,r;const l=+this.adsManager.getRemainingTime(),v=((a=(i=this.currentAd)==null?void 0:i.getDuration)==null?void 0:a.call(i))||0;let u=v-l;u=u>0?+u:0;const c=+(u/v)||0;(r=(s=this.config).onProgress)==null||r.call(s,{currentTime:u,duration:v,progress:c,remainingTime:l}),this.playheadAnimationRequestId=requestAnimationFrame(e)};this.playheadAnimationRequestId=requestAnimationFrame(e)}stopWatchProgress(){this.playheadAnimationRequestId&&cancelAnimationFrame(this.playheadAnimationRequestId)}destroy(){var e,i,a,s,r,l;(i=(e=this.adDisplayContainer).destroy)==null||i.call(e),(s=(a=this.adsManager).destroy)==null||s.call(a),(l=(r=this.adsLoader).destroy)==null||l.call(r),this.stopWatchProgress()}}const st=De({__name:"Vast.ce",setup(o){Oe(_=>{var b,d,y,A,w,M,D,q,x,T,P,j,O,S,V,I,W,F,z,B,H,N,Z,G,U,$,J,K,Q,X,Y,ee,te,ie,ae,oe,se,ne,re,le,de,ue,ce,he,ve,me,pe,ge,fe,be,ye,Ae,we,Me;return{"0cc95191":t(v).dimension[0],"0cc951b0":t(v).dimension[1],"14a96d36":((d=(b=t(c))==null?void 0:b.grid)==null?void 0:d.rows)||12,"6353b133":((A=(y=t(c))==null?void 0:y.grid)==null?void 0:A.columns)||12,"906555f6":((M=(w=t(c))==null?void 0:w.grid)==null?void 0:M.gap)||0,"46b8be7d":((x=(q=(D=t(p))==null?void 0:D.position)==null?void 0:q.coordinate)==null?void 0:x[0])||1,"7b9ef9be":((j=(P=(T=t(p))==null?void 0:T.position)==null?void 0:P.coordinate)==null?void 0:j[1])||1,"974b1cbe":((V=(S=(O=t(p))==null?void 0:O.position)==null?void 0:S.dimension)==null?void 0:V[0])||12,"1c3b9e80":((F=(W=(I=t(p))==null?void 0:I.position)==null?void 0:W.dimension)==null?void 0:F[1])||12,b56efb82:((H=(B=(z=t(m))==null?void 0:z.position)==null?void 0:B.coordinate)==null?void 0:H[0])||1,"6ba8f2b0":((G=(Z=(N=t(m))==null?void 0:N.position)==null?void 0:Z.coordinate)==null?void 0:G[1])||10,"515c3ea0":((J=($=(U=t(m))==null?void 0:U.position)==null?void 0:$.dimension)==null?void 0:J[0])||2,"0c381bf1":((X=(Q=(K=t(m))==null?void 0:K.position)==null?void 0:Q.dimension)==null?void 0:X[1])||2,e4821f8c:((te=(ee=(Y=t(g))==null?void 0:Y.position)==null?void 0:ee.coordinate)==null?void 0:te[0])||10,"14bfc5ce":((oe=(ae=(ie=t(g))==null?void 0:ie.position)==null?void 0:ae.coordinate)==null?void 0:oe[1])||10,"929add4e":((re=(ne=(se=t(g))==null?void 0:se.position)==null?void 0:ne.dimension)==null?void 0:re[0])||2,"28ce66cc":((ue=(de=(le=t(g))==null?void 0:le.position)==null?void 0:de.dimension)==null?void 0:ue[1])||2,"364d7eee":((ve=(he=(ce=t(f))==null?void 0:ce.position)==null?void 0:he.coordinate)==null?void 0:ve[0])||1,"1e2ffda8":((ge=(pe=(me=t(f))==null?void 0:me.position)==null?void 0:pe.coordinate)==null?void 0:ge[1])||12,"527af3ad":((ye=(be=(fe=t(f))==null?void 0:fe.position)==null?void 0:be.dimension)==null?void 0:ye[0])||12,"8b47bee8":((Me=(we=(Ae=t(f))==null?void 0:Ae.position)==null?void 0:we.dimension)==null?void 0:Me[1])||12,"4ecd4d68":a.value}});const e=C(),i=C(!0),a=C("0%"),s=new ot,{t:r}=ze(),{bridge:l}=Ie(),{type:v,properties:u}=We(),{root:c,ad:m,player:p,volume:g,progress:f}=u,Ee=Ve(),{handleReady:Re}=Fe();qe(()=>{const{xml:_,url:b}=c.settings;s.init(e.value,{onProgress:d=>{a.value=`${d.progress*100}%`},playbackController:()=>{l.on(Se,({isIntersecting:d})=>{d?s.play():s.pause()},{target:Ee.value,threshold:[0]}),Re()},url:b,xml:_})});const _e=()=>{i.value=s.toggleMute()};return xe(()=>{s.destroy()}),(_,b)=>{var d,y,A,w,M;return R(),k("div",{class:"root",style:L(t(c).style)},[h("div",{ref_key:"playerRef",ref:e,role:"link",class:"player",style:L((d=t(p))==null?void 0:d.style)},null,4),h("p",{class:"ad",style:L((y=t(m))==null?void 0:y.style)},Te(((A=t(m))==null?void 0:A.text.content)||t(r)("ad")),5),(R(),Pe(je(i.value?t(et):t($e)),{role:"button",class:"volume",style:L((w=t(g))==null?void 0:w.style),onClick:_e},null,8,["style"])),h("div",{class:"progress",style:L((M=t(f))==null?void 0:M.style)},null,4)],4)}}}),nt=`:host{aspect-ratio:var(--0cc95191)/var(--0cc951b0)}:host>div{width:100%;height:100%}@supports not (aspect-ratio: auto){:host:before{float:left;padding-top:calc(var(--0cc951b0) / var(--0cc95191) * 100%);content:""}:host:after{display:block;clear:both;content:""}:host>div{position:absolute;top:0;left:0;width:100%;height:100%}}.root{display:grid;grid-template-rows:repeat(var(--14a96d36),1fr);grid-template-columns:repeat(var(--6353b133),1fr);gap:var(--906555f6)}.player{grid-row:var(--7b9ef9be)/calc(var(--7b9ef9be) + var(--1c3b9e80) + 1);grid-column:var(--46b8be7d)/calc(var(--46b8be7d) + var(--974b1cbe) + 1)}.player>div{position:absolute!important;top:0!important;right:0!important;bottom:0!important;left:0!important;width:100%!important;height:100%!important}.player>iframe{position:absolute!important;top:0!important;right:0!important;bottom:0!important;left:0!important;width:100%!important;height:100%!important}.ad{grid-row:var(--6ba8f2b0)/calc(var(--6ba8f2b0) + var(--0c381bf1) + 1);grid-column:var(--b56efb82)/calc(var(--b56efb82) + var(--515c3ea0) + 1);display:grid;align-self:center;justify-self:center;font-size:.875rem;color:var(--color-600);mix-blend-mode:exclusion}.volume{grid-row:var(--14bfc5ce)/calc(var(--14bfc5ce) + var(--28ce66cc) + 1);grid-column:var(--e4821f8c)/calc(var(--e4821f8c) + var(--929add4e) + 1);display:grid;align-self:center;justify-self:center;width:24pt;height:24pt;color:var(--color-600);cursor:pointer;mix-blend-mode:exclusion}.progress{grid-row:var(--1e2ffda8)/calc(var(--1e2ffda8) + var(--8b47bee8) + 1);grid-column:var(--364d7eee)/calc(var(--364d7eee) + var(--527af3ad) + 1);align-self:flex-end;width:var(--4ecd4d68);height:.25rem;background:var(--color-600);border-radius:.125rem;mix-blend-mode:exclusion;opacity:.8;will-change:width}
`,rt=Be(st,[["styles",[nt]]]);export{rt as default};
